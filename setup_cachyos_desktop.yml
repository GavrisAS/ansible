- hosts: localhost
  connection: local
  become: yes # –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∑–∞–¥–∞—á —Ç—Ä–µ–±—É—é—Ç –ø—Ä–∞–≤ —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (sudo)

  vars:
    # –ü–∞–∫–µ—Ç—ã –∏–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ Arch/CachyOS
    pacman_packages:
      - nvidia-dkms       # –ü–æ—Å–ª–µ–¥–Ω–∏–µ –¥—Ä–∞–π–≤–µ—Ä—ã NVIDIA (DKMS –≤–µ—Ä—Å–∏—è –ª—É—á—à–µ –¥–ª—è –∫–∞—Å—Ç–æ–º–Ω—ã—Ö —è–¥–µ—Ä)
      - docker            # –°–∏—Å—Ç–µ–º–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏–∏
      - telegram-desktop
      - discord
      - code              # Visual Studio Code
      - flameshot
      - gramps
      - libreoffice-fresh # –°–≤–µ–∂–∞—è –≤–µ—Ä—Å–∏—è LibreOffice
      - qbittorrent
      - texmaker
      - thunderbird
      - firefox
      - virtualbox
      - virtualbox-host-dkms # –ú–æ–¥—É–ª–∏ —è–¥—Ä–∞ –¥–ª—è VirtualBox
      - vlc

    # –ü–∞–∫–µ—Ç—ã –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è AUR (Arch User Repository)
    aur_packages:
      - pycharm-professional
      - rustrover
      - lazydocker
      - zed-editor
      - lmstudio-bin
      - obsidian
      - yandex-browser
      - warp-terminal
      - nekoray
      - cursor-appimage-bin

  pre_tasks:
    - name: üîë –®–∞–≥ 0. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤
      pacman:
        update_cache: yes

    - name: üîë –®–∞–≥ 0.1. –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞–∫–µ—Ç–∞ —Å –∫–ª—é—á–∞–º–∏ CachyOS
      pacman:
        name: cachyos-keyring
        state: latest # –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –ø–æ—Å–ª–µ–¥–Ω—è—è –≤–µ—Ä—Å–∏—è

  tasks:
    - name: 1. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –ø–∞–∫–µ—Ç–æ–≤ —Å–∏—Å—Ç–µ–º—ã
      pacman:
        upgrade: yes

    - name: 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ 'base-devel' –¥–ª—è —Å–±–æ—Ä–∫–∏ AUR –ø–∞–∫–µ—Ç–æ–≤
      pacman:
        name: base-devel
        state: present

    - name: 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ yay (–ø–æ–ø—É–ª—è—Ä–Ω—ã–π AUR —Ö–µ–ª–ø–µ—Ä)
      kewlfft.aur.aur:
        name: yay
        state: present
      become_user: "{{ ansible_user_id }}" # –°–±–æ—Ä–∫–∞ –ø–∞–∫–µ—Ç–æ–≤ AUR –¥–æ–ª–∂–Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å—Å—è –æ—Ç –∏–º–µ–Ω–∏ –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

    - name: 4. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤ –∏–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤
      pacman:
        name: "{{ pacman_packages }}"
        state: present

    - name: 5. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤ –∏–∑ AUR —Å –ø–æ–º–æ—â—å—é yay
      kewlfft.aur.aur:
        use: yay
        name: "{{ aur_packages }}"
        state: present
      become_user: "{{ ansible_user_id }}" # –í–∞–∂–Ω–æ!

    - name: 6. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Docker
      block:
        - name: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –≥—Ä—É–ø–ø—É docker
          user:
            name: "{{ ansible_user_id }}"
            groups: docker
            append: yes

        - name: –í–∫–ª—é—á–µ–Ω–∏–µ –∏ –∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞ Docker
          systemd:
            name: docker
            enabled: yes
            state: started
      
    - name: 7. –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
      debug:
        msg: |
          ========================================================================
          –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!
          
          –í–ê–ñ–ù–û: –ß—Ç–æ–±—ã –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–ª—è Docker –∏ –¥—Ä–∞–π–≤–µ—Ä–æ–≤ NVIDIA/VirtualBox
          –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤—Å—Ç—É–ø–∏–ª–∏ –≤ —Å–∏–ª—É, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ü–ï–†–ï–ó–ê–ì–†–£–ó–ò–¢–¨ –∫–æ–º–ø—å—é—Ç–µ—Ä.
          
          –î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è VirtualBox –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –∑–∞–ø—É—Å—Ç–∏—Ç—å:
          'sudo modprobe vboxdrv' –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è.
          ========================================================================
